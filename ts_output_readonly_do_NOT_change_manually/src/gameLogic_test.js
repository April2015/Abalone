describe("In Abalone", function () {
    function expectMove(turnIndexBeforeMove, stateBeforeMove, move, isOk) {
        expect(gameLogic.isMoveOk({
            turnIndexBeforeMove: turnIndexBeforeMove,
            turnIndexAfterMove: null,
            stateBeforeMove: stateBeforeMove,
            stateAfterMove: null,
            move: move,
            numberOfPlayers: null })).toBe(isOk);
    }
    function expectMoveOk(turnIndexBeforeMove, stateBeforeMove, move) {
        expectMove(turnIndexBeforeMove, stateBeforeMove, move, true);
    }
    function expectIllegalMove(turnIndexBeforeMove, stateBeforeMove, move) {
        expectMove(turnIndexBeforeMove, stateBeforeMove, move, false);
    }
    it("moving 3 black marbles in a line from initial state is legal", function () {
        expectMoveOk(0, {}, [{ setTurn: { turnIndex: 1 } },
            { set: { key: 'action', value: { isInline: true, direction: { row: -1, col: 1 },
                        selfMarbles: [{ row: 8, col: 4 }, { row: 7, col: 5 }, { row: 6, col: 6 }],
                        opponentMarbles: [] } } },
            { set: { key: 'state', value: { board: [
                            ['', '', '', '', 'W', '', 'W', '', 'O', '', 'B', '', 'B', '', '', '', ''],
                            ['', '', '', 'W', '', 'W', '', 'W', '', 'B', '', 'B', '', 'B', '', '', ''],
                            ['', '', 'O', '', 'W', '', 'W', '', 'O', '', 'B', '', 'B', '', 'O', '', ''],
                            ['', 'O', '', 'O', '', 'O', '', 'O', '', 'O', '', 'O', '', 'O', '', 'O', ''],
                            ['O', '', 'O', '', 'O', '', 'O', '', 'O', '', 'O', '', 'O', '', 'O', '', 'O'],
                            ['', 'O', '', 'O', '', 'O', '', 'B', '', 'O', '', 'O', '', 'O', '', 'O', ''],
                            ['', '', 'O', '', 'B', '', 'B', '', 'O', '', 'W', '', 'W', '', 'O', '', ''],
                            ['', '', '', 'B', '', 'B', '', 'B', '', 'W', '', 'W', '', 'W', '', '', ''],
                            ['', '', '', '', 'O', '', 'B', '', 'O', '', 'W', '', 'W', '', '', '', '']],
                        removedMarbles: { black: 0, white: 0 } } } }]);
    });
    it("an inline move with 3 pushing 1 is legal", function () {
        expectMoveOk(1, { board: [
                ['', '', '', '', 'O', '', 'O', '', 'B', '', 'O', '', 'O', '', '', '', ''],
                ['', '', '', 'O', '', 'O', '', 'B', '', 'O', '', 'B', '', 'B', '', '', ''],
                ['', '', 'O', '', 'O', '', 'O', '', 'W', '', 'O', '', 'O', '', 'O', '', ''],
                ['', 'O', '', 'O', '', 'W', '', 'W', '', 'W', '', 'B', '', 'B', '', 'B', ''],
                ['O', '', 'O', '', 'O', '', 'W', '', 'O', '', 'W', '', 'O', '', 'O', '', 'O'],
                ['', 'O', '', 'O', '', 'O', '', 'W', '', 'B', '', 'W', '', 'W', '', 'O', ''],
                ['', '', 'O', '', 'O', '', 'B', '', 'B', '', 'B', '', 'O', '', 'O', '', ''],
                ['', '', '', 'B', '', 'O', '', 'W', '', 'O', '', 'B', '', 'B', '', '', ''],
                ['', '', '', '', 'O', '', 'O', '', 'W', '', 'O', '', 'W', '', '', '', '']],
            removedMarbles: { black: 0, white: 2 } }, [{ setTurn: { turnIndex: 0 } },
            { set: { key: 'action', value: { isInline: true, direction: { row: -1, col: -1 },
                        selfMarbles: [{ row: 4, col: 10 }, { row: 3, col: 9 },
                            { row: 2, col: 8 }],
                        opponentMarbles: [{ row: 1, col: 7 }] } } },
            { set: { key: 'state', value: { board: [
                            ['', '', '', '', 'O', '', 'B', '', 'B', '', 'O', '', 'O', '', '', '', ''],
                            ['', '', '', 'O', '', 'O', '', 'W', '', 'O', '', 'B', '', 'B', '', '', ''],
                            ['', '', 'O', '', 'O', '', 'O', '', 'W', '', 'O', '', 'O', '', 'O', '', ''],
                            ['', 'O', '', 'O', '', 'W', '', 'W', '', 'W', '', 'B', '', 'B', '', 'B', ''],
                            ['O', '', 'O', '', 'O', '', 'W', '', 'O', '', 'O', '', 'O', '', 'O', '', 'O'],
                            ['', 'O', '', 'O', '', 'O', '', 'W', '', 'B', '', 'W', '', 'W', '', 'O', ''],
                            ['', '', 'O', '', 'O', '', 'B', '', 'B', '', 'B', '', 'O', '', 'O', '', ''],
                            ['', '', '', 'B', '', 'O', '', 'W', '', 'O', '', 'B', '', 'B', '', '', ''],
                            ['', '', '', '', 'O', '', 'O', '', 'W', '', 'O', '', 'W', '', '', '', '']],
                        removedMarbles: { black: 0, white: 2 } } } }]);
    });
    it("an inline move with 4 pushing 1 is illegal", function () {
        expectIllegalMove(1, { board: [
                ['', '', '', '', 'O', '', 'O', '', 'B', '', 'O', '', 'O', '', '', '', ''],
                ['', '', '', 'O', '', 'O', '', 'B', '', 'O', '', 'B', '', 'B', '', '', ''],
                ['', '', 'O', '', 'O', '', 'O', '', 'W', '', 'O', '', 'O', '', 'O', '', ''],
                ['', 'O', '', 'O', '', 'W', '', 'W', '', 'W', '', 'B', '', 'B', '', 'B', ''],
                ['O', '', 'O', '', 'O', '', 'W', '', 'O', '', 'W', '', 'O', '', 'O', '', 'O'],
                ['', 'O', '', 'O', '', 'O', '', 'W', '', 'B', '', 'W', '', 'W', '', 'O', ''],
                ['', '', 'O', '', 'O', '', 'B', '', 'B', '', 'B', '', 'O', '', 'O', '', ''],
                ['', '', '', 'B', '', 'O', '', 'W', '', 'O', '', 'B', '', 'B', '', '', ''],
                ['', '', '', '', 'O', '', 'O', '', 'W', '', 'O', '', 'W', '', '', '', '']],
            removedMarbles: { black: 0, white: 2 } }, [{ setTurn: { turnIndex: 0 } },
            { set: { key: 'action', value: { isInline: true, direction: { row: -1, col: -1 },
                        selfMarbles: [{ row: 5, col: 11 }, { row: 4, col: 10 }, { row: 3, col: 9 },
                            { row: 2, col: 8 }],
                        opponentMarbles: [{ row: 1, col: 7 }] } } },
            { set: { key: 'state', value: { board: [
                            ['', '', '', '', 'O', '', 'B', '', 'B', '', 'O', '', 'O', '', '', '', ''],
                            ['', '', '', 'O', '', 'O', '', 'W', '', 'O', '', 'B', '', 'B', '', '', ''],
                            ['', '', 'O', '', 'O', '', 'O', '', 'W', '', 'O', '', 'O', '', 'O', '', ''],
                            ['', 'O', '', 'O', '', 'W', '', 'W', '', 'W', '', 'B', '', 'B', '', 'B', ''],
                            ['O', '', 'O', '', 'O', '', 'W', '', 'O', '', 'W', '', 'O', '', 'O', '', 'O'],
                            ['', 'O', '', 'O', '', 'O', '', 'W', '', 'B', '', 'O', '', 'W', '', 'O', ''],
                            ['', '', 'O', '', 'O', '', 'B', '', 'B', '', 'B', '', 'O', '', 'O', '', ''],
                            ['', '', '', 'B', '', 'O', '', 'W', '', 'O', '', 'B', '', 'B', '', '', ''],
                            ['', '', '', '', 'O', '', 'O', '', 'W', '', 'O', '', 'W', '', '', '', '']],
                        removedMarbles: { black: 0, white: 2 } } } }]);
    });
    it("an inline move with 3 pushing 3 is illegal", function () {
        expectIllegalMove(1, { board: [
                ['', '', '', '', 'O', '', 'O', '', 'B', '', 'O', '', 'O', '', '', '', ''],
                ['', '', '', 'O', '', 'O', '', 'B', '', 'O', '', 'B', '', 'B', '', '', ''],
                ['', '', 'O', '', 'O', '', 'O', '', 'W', '', 'O', '', 'O', '', 'O', '', ''],
                ['', 'O', '', 'O', '', 'W', '', 'W', '', 'W', '', 'B', '', 'B', '', 'B', ''],
                ['O', '', 'O', '', 'O', '', 'W', '', 'O', '', 'W', '', 'O', '', 'O', '', 'O'],
                ['', 'O', '', 'O', '', 'O', '', 'W', '', 'B', '', 'W', '', 'W', '', 'O', ''],
                ['', '', 'O', '', 'O', '', 'B', '', 'B', '', 'B', '', 'O', '', 'O', '', ''],
                ['', '', '', 'B', '', 'O', '', 'W', '', 'O', '', 'B', '', 'B', '', '', ''],
                ['', '', '', '', 'O', '', 'O', '', 'W', '', 'O', '', 'W', '', '', '', '']],
            removedMarbles: { black: 0, white: 2 } }, [{ setTurn: { turnIndex: 0 } },
            { set: { key: 'action', value: { isInline: true, direction: { row: 0, col: 2 },
                        selfMarbles: [{ row: 3, col: 5 }, { row: 3, col: 7 }, { row: 3, col: 9 }],
                        opponentMarbles: [{ row: 3, col: 11 }, { row: 3, col: 13 }, { row: 3, col: 15 }] } } },
            { set: { key: 'state', value: { board: [
                            ['', '', '', '', 'O', '', 'O', '', 'B', '', 'O', '', 'O', '', '', '', ''],
                            ['', '', '', 'O', '', 'O', '', 'B', '', 'O', '', 'B', '', 'B', '', '', ''],
                            ['', '', 'O', '', 'O', '', 'O', '', 'W', '', 'O', '', 'O', '', 'O', '', ''],
                            ['', 'O', '', 'O', '', 'O', '', 'W', '', 'W', '', 'W', '', 'B', '', 'B', ''],
                            ['O', '', 'O', '', 'O', '', 'W', '', 'O', '', 'W', '', 'O', '', 'O', '', 'O'],
                            ['', 'O', '', 'O', '', 'O', '', 'W', '', 'B', '', 'W', '', 'W', '', 'O', ''],
                            ['', '', 'O', '', 'O', '', 'B', '', 'B', '', 'B', '', 'O', '', 'O', '', ''],
                            ['', '', '', 'B', '', 'O', '', 'W', '', 'O', '', 'B', '', 'B', '', '', ''],
                            ['', '', '', '', 'O', '', 'O', '', 'W', '', 'O', '', 'W', '', '', '', '']],
                        removedMarbles: { black: 1, white: 2 } } } }]);
    });
    it("an inline move with 2 pushing 1 to open space is legal", function () {
        expectMoveOk(0, { board: [
                ['', '', '', '', 'O', '', 'O', '', 'O', '', 'B', '', 'B', '', '', '', ''],
                ['', '', '', 'W', '', 'W', '', 'W', '', 'B', '', 'B', '', 'B', '', '', ''],
                ['', '', 'O', '', 'O', '', 'W', '', 'W', '', 'W', '', 'B', '', 'B', '', ''],
                ['', 'O', '', 'O', '', 'O', '', 'W', '', 'O', '', 'O', '', 'O', '', 'O', ''],
                ['O', '', 'O', '', 'O', '', 'O', '', 'O', '', 'O', '', 'O', '', 'O', '', 'O'],
                ['', 'O', '', 'O', '', 'O', '', 'B', '', 'B', '', 'O', '', 'O', '', 'O', ''],
                ['', '', 'O', '', 'B', '', 'B', '', 'B', '', 'W', '', 'W', '', 'O', '', ''],
                ['', '', '', 'B', '', 'B', '', 'O', '', 'W', '', 'W', '', 'W', '', '', ''],
                ['', '', '', '', 'O', '', 'O', '', 'O', '', 'W', '', 'W', '', '', '', '']],
            removedMarbles: { black: 0, white: 0 } }, [{ setTurn: { turnIndex: 1 } },
            { set: { key: 'action', value: { isInline: true, direction: { row: 1, col: -1 },
                        selfMarbles: [{ row: 0, col: 12 }, { row: 1, col: 11 }],
                        opponentMarbles: [{ row: 2, col: 10 }] } } },
            { set: { key: 'state', value: { board: [
                            ['', '', '', '', 'O', '', 'O', '', 'O', '', 'B', '', 'O', '', '', '', ''],
                            ['', '', '', 'W', '', 'W', '', 'W', '', 'B', '', 'B', '', 'B', '', '', ''],
                            ['', '', 'O', '', 'O', '', 'W', '', 'W', '', 'B', '', 'B', '', 'B', '', ''],
                            ['', 'O', '', 'O', '', 'O', '', 'W', '', 'W', '', 'O', '', 'O', '', 'O', ''],
                            ['O', '', 'O', '', 'O', '', 'O', '', 'O', '', 'O', '', 'O', '', 'O', '', 'O'],
                            ['', 'O', '', 'O', '', 'O', '', 'B', '', 'B', '', 'O', '', 'O', '', 'O', ''],
                            ['', '', 'O', '', 'B', '', 'B', '', 'B', '', 'W', '', 'W', '', 'O', '', ''],
                            ['', '', '', 'B', '', 'B', '', 'O', '', 'W', '', 'W', '', 'W', '', '', ''],
                            ['', '', '', '', 'O', '', 'O', '', 'O', '', 'W', '', 'W', '', '', '', '']],
                        removedMarbles: { black: 0, white: 0 } } } }]);
    });
    it("an inline move that removes opponent's inside marble is illegal", function () {
        expectIllegalMove(0, { board: [
                ['', '', '', '', 'O', '', 'O', '', 'O', '', 'B', '', 'B', '', '', '', ''],
                ['', '', '', 'W', '', 'W', '', 'W', '', 'B', '', 'B', '', 'B', '', '', ''],
                ['', '', 'O', '', 'O', '', 'W', '', 'W', '', 'W', '', 'B', '', 'B', '', ''],
                ['', 'O', '', 'O', '', 'O', '', 'W', '', 'O', '', 'O', '', 'O', '', 'O', ''],
                ['O', '', 'O', '', 'O', '', 'O', '', 'O', '', 'O', '', 'O', '', 'O', '', 'O'],
                ['', 'O', '', 'O', '', 'O', '', 'B', '', 'B', '', 'O', '', 'O', '', 'O', ''],
                ['', '', 'O', '', 'B', '', 'B', '', 'B', '', 'W', '', 'W', '', 'O', '', ''],
                ['', '', '', 'B', '', 'B', '', 'O', '', 'W', '', 'W', '', 'W', '', '', ''],
                ['', '', '', '', 'O', '', 'O', '', 'O', '', 'W', '', 'W', '', '', '', '']],
            removedMarbles: { black: 0, white: 0 } }, [{ setTurn: { turnIndex: 1 } },
            { set: { key: 'action', value: { isInline: true, direction: { row: 1, col: -1 },
                        selfMarbles: [{ row: 0, col: 12 }, { row: 1, col: 11 }],
                        opponentMarbles: [{ row: 2, col: 10 }] } } },
            { set: { key: 'state', value: { board: [
                            ['', '', '', '', 'O', '', 'O', '', 'O', '', 'B', '', 'O', '', '', '', ''],
                            ['', '', '', 'W', '', 'W', '', 'W', '', 'B', '', 'B', '', 'B', '', '', ''],
                            ['', '', 'O', '', 'O', '', 'W', '', 'W', '', 'B', '', 'B', '', 'B', '', ''],
                            ['', 'O', '', 'O', '', 'O', '', 'W', '', 'O', '', 'O', '', 'O', '', 'O', ''],
                            ['O', '', 'O', '', 'O', '', 'O', '', 'O', '', 'O', '', 'O', '', 'O', '', 'O'],
                            ['', 'O', '', 'O', '', 'O', '', 'B', '', 'B', '', 'O', '', 'O', '', 'O', ''],
                            ['', '', 'O', '', 'B', '', 'B', '', 'B', '', 'W', '', 'W', '', 'O', '', ''],
                            ['', '', '', 'B', '', 'B', '', 'O', '', 'W', '', 'W', '', 'W', '', '', ''],
                            ['', '', '', '', 'O', '', 'O', '', 'O', '', 'W', '', 'W', '', '', '', '']],
                        removedMarbles: { black: 0, white: 1 } } } }]);
    });
    it("an inline move with 3 pushing 2 off edge is legal", function () {
        expectMoveOk(0, { board: [
                ['', '', '', '', 'O', '', 'O', '', 'B', '', 'O', '', 'O', '', '', '', ''],
                ['', '', '', 'O', '', 'O', '', 'B', '', 'O', '', 'B', '', 'B', '', '', ''],
                ['', '', 'O', '', 'W', '', 'O', '', 'W', '', 'O', '', 'O', '', 'O', '', ''],
                ['', 'O', '', 'O', '', 'W', '', 'W', '', 'W', '', 'B', '', 'B', '', 'B', ''],
                ['O', '', 'O', '', 'O', '', 'W', '', 'B', '', 'W', '', 'O', '', 'O', '', 'O'],
                ['', 'O', '', 'O', '', 'O', '', 'B', '', 'B', '', 'W', '', 'W', '', 'O', ''],
                ['', '', 'O', '', 'O', '', 'B', '', 'B', '', 'B', '', 'O', '', 'O', '', ''],
                ['', '', '', 'B', '', 'O', '', 'W', '', 'O', '', 'W', '', 'W', '', '', ''],
                ['', '', '', '', 'O', '', 'O', '', 'W', '', 'O', '', 'W', '', '', '', '']],
            removedMarbles: { black: 0, white: 0 } }, [{ setTurn: { turnIndex: 1 } },
            { set: { key: 'action', value: { isInline: true, direction: { row: 1, col: 1 },
                        selfMarbles: [{ row: 4, col: 8 }, { row: 5, col: 9 }, { row: 6, col: 10 }],
                        opponentMarbles: [{ row: 7, col: 11 }, { row: 8, col: 12 }] } } },
            { set: { key: 'state', value: { board: [
                            ['', '', '', '', 'O', '', 'O', '', 'B', '', 'O', '', 'O', '', '', '', ''],
                            ['', '', '', 'O', '', 'O', '', 'B', '', 'O', '', 'B', '', 'B', '', '', ''],
                            ['', '', 'O', '', 'W', '', 'O', '', 'W', '', 'O', '', 'O', '', 'O', '', ''],
                            ['', 'O', '', 'O', '', 'W', '', 'W', '', 'W', '', 'B', '', 'B', '', 'B', ''],
                            ['O', '', 'O', '', 'O', '', 'W', '', 'O', '', 'W', '', 'O', '', 'O', '', 'O'],
                            ['', 'O', '', 'O', '', 'O', '', 'B', '', 'B', '', 'W', '', 'W', '', 'O', ''],
                            ['', '', 'O', '', 'O', '', 'B', '', 'B', '', 'B', '', 'O', '', 'O', '', ''],
                            ['', '', '', 'B', '', 'O', '', 'W', '', 'O', '', 'B', '', 'W', '', '', ''],
                            ['', '', '', '', 'O', '', 'O', '', 'W', '', 'O', '', 'W', '', '', '', '']],
                        removedMarbles: { black: 0, white: 1 } } } }]);
    });
    it("an inline move with 3 pushing 2 to open space is legal", function () {
        expectMoveOk(1, { board: [
                ['', '', '', '', 'O', '', 'O', '', 'B', '', 'O', '', 'O', '', '', '', ''],
                ['', '', '', 'O', '', 'O', '', 'B', '', 'O', '', 'B', '', 'B', '', '', ''],
                ['', '', 'O', '', 'W', '', 'O', '', 'W', '', 'O', '', 'O', '', 'O', '', ''],
                ['', 'O', '', 'O', '', 'W', '', 'W', '', 'W', '', 'B', '', 'B', '', 'B', ''],
                ['O', '', 'O', '', 'O', '', 'W', '', 'O', '', 'W', '', 'O', '', 'O', '', 'O'],
                ['', 'O', '', 'O', '', 'O', '', 'B', '', 'B', '', 'W', '', 'W', '', 'O', ''],
                ['', '', 'O', '', 'O', '', 'B', '', 'B', '', 'B', '', 'O', '', 'O', '', ''],
                ['', '', '', 'B', '', 'O', '', 'W', '', 'O', '', 'B', '', 'W', '', '', ''],
                ['', '', '', '', 'O', '', 'O', '', 'W', '', 'O', '', 'W', '', '', '', '']],
            removedMarbles: { black: 0, white: 1 } }, [{ setTurn: { turnIndex: 0 } },
            { set: { key: 'action', value: { isInline: true, direction: { row: 1, col: 1 },
                        selfMarbles: [{ row: 2, col: 4 }, { row: 3, col: 5 }, { row: 4, col: 6 }],
                        opponentMarbles: [{ row: 5, col: 7 }, { row: 6, col: 8 }] } } },
            { set: { key: 'state', value: { board: [
                            ['', '', '', '', 'O', '', 'O', '', 'B', '', 'O', '', 'O', '', '', '', ''],
                            ['', '', '', 'O', '', 'O', '', 'B', '', 'O', '', 'B', '', 'B', '', '', ''],
                            ['', '', 'O', '', 'O', '', 'O', '', 'W', '', 'O', '', 'O', '', 'O', '', ''],
                            ['', 'O', '', 'O', '', 'W', '', 'W', '', 'W', '', 'B', '', 'B', '', 'B', ''],
                            ['O', '', 'O', '', 'O', '', 'W', '', 'O', '', 'W', '', 'O', '', 'O', '', 'O'],
                            ['', 'O', '', 'O', '', 'O', '', 'W', '', 'B', '', 'W', '', 'W', '', 'O', ''],
                            ['', '', 'O', '', 'O', '', 'B', '', 'B', '', 'B', '', 'O', '', 'O', '', ''],
                            ['', '', '', 'B', '', 'O', '', 'W', '', 'B', '', 'B', '', 'W', '', '', ''],
                            ['', '', '', '', 'O', '', 'O', '', 'W', '', 'O', '', 'W', '', '', '', '']],
                        removedMarbles: { black: 0, white: 1 } } } }]);
    });
    it("an inline move with 3 pushing 1 blocked by some marble is illegal", function () {
        expectIllegalMove(1, { board: [
                ['', '', '', '', 'O', '', 'O', '', 'B', '', 'O', '', 'O', '', '', '', ''],
                ['', '', '', 'O', '', 'O', '', 'B', '', 'O', '', 'B', '', 'B', '', '', ''],
                ['', '', 'O', '', 'W', '', 'O', '', 'W', '', 'O', '', 'O', '', 'O', '', ''],
                ['', 'O', '', 'O', '', 'W', '', 'W', '', 'W', '', 'B', '', 'B', '', 'B', ''],
                ['O', '', 'O', '', 'O', '', 'W', '', 'O', '', 'W', '', 'O', '', 'O', '', 'O'],
                ['', 'O', '', 'O', '', 'O', '', 'B', '', 'B', '', 'W', '', 'W', '', 'O', ''],
                ['', '', 'O', '', 'O', '', 'B', '', 'B', '', 'B', '', 'O', '', 'O', '', ''],
                ['', '', '', 'B', '', 'O', '', 'W', '', 'O', '', 'B', '', 'W', '', '', ''],
                ['', '', '', '', 'O', '', 'O', '', 'W', '', 'O', '', 'W', '', '', '', '']],
            removedMarbles: { black: 0, white: 1 } }, [{ setTurn: { turnIndex: 0 } },
            { set: { key: 'action', value: { isInline: true, direction: { row: 1, col: 1 },
                        selfMarbles: [{ row: 2, col: 4 }, { row: 3, col: 5 }, { row: 4, col: 6 }],
                        opponentMarbles: [{ row: 5, col: 7 }] } } },
            { set: { key: 'state', value: { board: [
                            ['', '', '', '', 'O', '', 'O', '', 'B', '', 'O', '', 'O', '', '', '', ''],
                            ['', '', '', 'O', '', 'O', '', 'B', '', 'O', '', 'B', '', 'B', '', '', ''],
                            ['', '', 'O', '', 'O', '', 'O', '', 'W', '', 'O', '', 'O', '', 'O', '', ''],
                            ['', 'O', '', 'O', '', 'W', '', 'W', '', 'W', '', 'B', '', 'B', '', 'B', ''],
                            ['O', '', 'O', '', 'O', '', 'W', '', 'O', '', 'W', '', 'O', '', 'O', '', 'O'],
                            ['', 'O', '', 'O', '', 'O', '', 'W', '', 'B', '', 'W', '', 'W', '', 'O', ''],
                            ['', '', 'O', '', 'O', '', 'B', '', 'B', '', 'B', '', 'O', '', 'O', '', ''],
                            ['', '', '', 'B', '', 'O', '', 'W', '', 'B', '', 'B', '', 'W', '', '', ''],
                            ['', '', '', '', 'O', '', 'O', '', 'W', '', 'O', '', 'W', '', '', '', '']],
                        removedMarbles: { black: 0, white: 1 } } } }]);
    });
    it("Using opponent's marbles to push yours is illegal", function () {
        expectIllegalMove(1, { board: [
                ['', '', '', '', 'O', '', 'O', '', 'O', '', 'B', '', 'B', '', '', '', ''],
                ['', '', '', 'W', '', 'W', '', 'W', '', 'B', '', 'B', '', 'B', '', '', ''],
                ['', '', 'O', '', 'O', '', 'W', '', 'W', '', 'W', '', 'B', '', 'B', '', ''],
                ['', 'O', '', 'O', '', 'O', '', 'W', '', 'O', '', 'O', '', 'O', '', 'O', ''],
                ['O', '', 'O', '', 'O', '', 'O', '', 'O', '', 'O', '', 'O', '', 'O', '', 'O'],
                ['', 'O', '', 'O', '', 'O', '', 'B', '', 'B', '', 'O', '', 'O', '', 'O', ''],
                ['', '', 'O', '', 'B', '', 'B', '', 'B', '', 'W', '', 'W', '', 'O', '', ''],
                ['', '', '', 'B', '', 'B', '', 'O', '', 'W', '', 'W', '', 'W', '', '', ''],
                ['', '', '', '', 'O', '', 'O', '', 'O', '', 'W', '', 'W', '', '', '', '']],
            removedMarbles: { black: 0, white: 0 } }, [{ setTurn: { turnIndex: 0 } },
            { set: { key: 'action', value: { isInline: true, direction: { row: 1, col: -1 },
                        selfMarbles: [{ row: 0, col: 12 }, { row: 1, col: 11 }],
                        opponentMarbles: [{ row: 2, col: 10 }] } } },
            { set: { key: 'state', value: { board: [
                            ['', '', '', '', 'O', '', 'O', '', 'O', '', 'B', '', 'O', '', '', '', ''],
                            ['', '', '', 'W', '', 'W', '', 'W', '', 'B', '', 'B', '', 'B', '', '', ''],
                            ['', '', 'O', '', 'O', '', 'W', '', 'W', '', 'B', '', 'B', '', 'B', '', ''],
                            ['', 'O', '', 'O', '', 'O', '', 'W', '', 'W', '', 'O', '', 'O', '', 'O', ''],
                            ['O', '', 'O', '', 'O', '', 'O', '', 'O', '', 'O', '', 'O', '', 'O', '', 'O'],
                            ['', 'O', '', 'O', '', 'O', '', 'B', '', 'B', '', 'O', '', 'O', '', 'O', ''],
                            ['', '', 'O', '', 'B', '', 'B', '', 'B', '', 'W', '', 'W', '', 'O', '', ''],
                            ['', '', '', 'B', '', 'B', '', 'O', '', 'W', '', 'W', '', 'W', '', '', ''],
                            ['', '', '', '', 'O', '', 'O', '', 'O', '', 'W', '', 'W', '', '', '', '']],
                        removedMarbles: { black: 0, white: 0 } } } }]);
    });
    it("an inline move with 2 pushing 1 blocked by some marble is illegal", function () {
        expectIllegalMove(1, { board: [
                ['', '', '', '', 'O', '', 'O', '', 'B', '', 'O', '', 'O', '', '', '', ''],
                ['', '', '', 'O', '', 'O', '', 'B', '', 'O', '', 'B', '', 'B', '', '', ''],
                ['', '', 'O', '', 'O', '', 'O', '', 'O', '', 'O', '', 'O', '', 'O', '', ''],
                ['', 'O', '', 'O', '', 'O', '', 'O', '', 'W', '', 'O', '', 'O', '', 'O', ''],
                ['O', '', 'O', '', 'O', '', 'W', '', 'W', '', 'W', '', 'B', '', 'B', '', 'B'],
                ['', 'O', '', 'O', '', 'W', '', 'W', '', 'B', '', 'W', '', 'W', '', 'O', ''],
                ['', '', 'O', '', 'O', '', 'B', '', 'W', '', 'O', '', 'O', '', 'O', '', ''],
                ['', '', '', 'B', '', 'O', '', 'W', '', 'B', '', 'B', '', 'B', '', '', ''],
                ['', '', '', '', 'O', '', 'O', '', 'B', '', 'O', '', 'W', '', '', '', '']],
            removedMarbles: { black: 0, white: 3 } }, [{ setTurn: { turnIndex: 0 } },
            { set: { key: 'action', value: { isInline: true, direction: { row: -1, col: 1 },
                        selfMarbles: [{ row: 7, col: 7 }, { row: 6, col: 8 }],
                        opponentMarbles: [{ row: 5, col: 9 }] } } },
            { set: { key: 'state', value: { board: [
                            ['', '', '', '', 'O', '', 'O', '', 'B', '', 'O', '', 'O', '', '', '', ''],
                            ['', '', '', 'O', '', 'O', '', 'B', '', 'O', '', 'B', '', 'B', '', '', ''],
                            ['', '', 'O', '', 'O', '', 'O', '', 'O', '', 'O', '', 'O', '', 'O', '', ''],
                            ['', 'O', '', 'O', '', 'O', '', 'O', '', 'W', '', 'W', '', 'O', '', 'O', ''],
                            ['O', '', 'O', '', 'O', '', 'W', '', 'W', '', 'B', '', 'B', '', 'B', '', 'B'],
                            ['', 'O', '', 'O', '', 'W', '', 'W', '', 'W', '', 'W', '', 'W', '', 'O', ''],
                            ['', '', 'O', '', 'O', '', 'B', '', 'W', '', 'O', '', 'O', '', 'O', '', ''],
                            ['', '', '', 'B', '', 'O', '', 'O', '', 'B', '', 'B', '', 'B', '', '', ''],
                            ['', '', '', '', 'O', '', 'O', '', 'B', '', 'O', '', 'W', '', '', '', '']],
                        removedMarbles: { black: 0, white: 3 } } } }]);
    });
    it("an inline move with marbles given in the opposite direction is illegal", function () {
        expectIllegalMove(1, { board: [
                ['', '', '', '', 'O', '', 'O', '', 'O', '', 'B', '', 'O', '', '', '', ''],
                ['', '', '', 'W', '', 'O', '', 'O', '', 'B', '', 'B', '', 'B', '', '', ''],
                ['', '', 'O', '', 'W', '', 'O', '', 'W', '', 'O', '', 'O', '', 'O', '', ''],
                ['', 'O', '', 'O', '', 'W', '', 'W', '', 'W', '', 'B', '', 'B', '', 'B', ''],
                ['O', '', 'O', '', 'O', '', 'O', '', 'B', '', 'W', '', 'O', '', 'O', '', 'O'],
                ['', 'O', '', 'O', '', 'O', '', 'B', '', 'B', '', 'W', '', 'W', '', 'O', ''],
                ['', '', 'O', '', 'O', '', 'B', '', 'B', '', 'B', '', 'O', '', 'O', '', ''],
                ['', '', '', 'B', '', 'O', '', 'O', '', 'W', '', 'W', '', 'W', '', '', ''],
                ['', '', '', '', 'O', '', 'O', '', 'O', '', 'W', '', 'W', '', '', '', '']],
            removedMarbles: { black: 0, white: 0 } }, [{ setTurn: { turnIndex: 0 } },
            { set: { key: 'action', value: { isInline: true, direction: { row: 1, col: 1 },
                        selfMarbles: [{ row: 3, col: 5 }, { row: 2, col: 4 }, { row: 1, col: 3 }],
                        opponentMarbles: [] } } },
            { set: { key: 'state', value: { board: [
                            ['', '', '', '', 'O', '', 'O', '', 'O', '', 'B', '', 'O', '', '', '', ''],
                            ['', '', '', 'O', '', 'O', '', 'O', '', 'B', '', 'B', '', 'B', '', '', ''],
                            ['', '', 'O', '', 'W', '', 'O', '', 'W', '', 'O', '', 'O', '', 'O', '', ''],
                            ['', 'O', '', 'O', '', 'W', '', 'W', '', 'W', '', 'B', '', 'B', '', 'B', ''],
                            ['O', '', 'O', '', 'O', '', 'W', '', 'B', '', 'W', '', 'O', '', 'O', '', 'O'],
                            ['', 'O', '', 'O', '', 'O', '', 'B', '', 'B', '', 'W', '', 'W', '', 'O', ''],
                            ['', '', 'O', '', 'O', '', 'B', '', 'B', '', 'B', '', 'O', '', 'O', '', ''],
                            ['', '', '', 'B', '', 'O', '', 'O', '', 'W', '', 'W', '', 'W', '', '', ''],
                            ['', '', '', '', 'O', '', 'O', '', 'O', '', 'W', '', 'W', '', '', '', '']],
                        removedMarbles: { black: 0, white: 0 } } } }]);
    });
    it("an inline move with marbles given in the same direction is legal", function () {
        expectMoveOk(1, { board: [
                ['', '', '', '', 'O', '', 'O', '', 'O', '', 'B', '', 'O', '', '', '', ''],
                ['', '', '', 'W', '', 'O', '', 'O', '', 'B', '', 'B', '', 'B', '', '', ''],
                ['', '', 'O', '', 'W', '', 'O', '', 'W', '', 'O', '', 'O', '', 'O', '', ''],
                ['', 'O', '', 'O', '', 'W', '', 'W', '', 'W', '', 'B', '', 'B', '', 'B', ''],
                ['O', '', 'O', '', 'O', '', 'O', '', 'B', '', 'W', '', 'O', '', 'O', '', 'O'],
                ['', 'O', '', 'O', '', 'O', '', 'B', '', 'B', '', 'W', '', 'W', '', 'O', ''],
                ['', '', 'O', '', 'O', '', 'B', '', 'B', '', 'B', '', 'O', '', 'O', '', ''],
                ['', '', '', 'B', '', 'O', '', 'O', '', 'W', '', 'W', '', 'W', '', '', ''],
                ['', '', '', '', 'O', '', 'O', '', 'O', '', 'W', '', 'W', '', '', '', '']],
            removedMarbles: { black: 0, white: 0 } }, [{ setTurn: { turnIndex: 0 } },
            { set: { key: 'action', value: { isInline: true, direction: { row: 1, col: 1 },
                        selfMarbles: [{ row: 1, col: 3 }, { row: 2, col: 4 }, { row: 3, col: 5 }],
                        opponentMarbles: [] } } },
            { set: { key: 'state', value: { board: [
                            ['', '', '', '', 'O', '', 'O', '', 'O', '', 'B', '', 'O', '', '', '', ''],
                            ['', '', '', 'O', '', 'O', '', 'O', '', 'B', '', 'B', '', 'B', '', '', ''],
                            ['', '', 'O', '', 'W', '', 'O', '', 'W', '', 'O', '', 'O', '', 'O', '', ''],
                            ['', 'O', '', 'O', '', 'W', '', 'W', '', 'W', '', 'B', '', 'B', '', 'B', ''],
                            ['O', '', 'O', '', 'O', '', 'W', '', 'B', '', 'W', '', 'O', '', 'O', '', 'O'],
                            ['', 'O', '', 'O', '', 'O', '', 'B', '', 'B', '', 'W', '', 'W', '', 'O', ''],
                            ['', '', 'O', '', 'O', '', 'B', '', 'B', '', 'B', '', 'O', '', 'O', '', ''],
                            ['', '', '', 'B', '', 'O', '', 'O', '', 'W', '', 'W', '', 'W', '', '', ''],
                            ['', '', '', '', 'O', '', 'O', '', 'O', '', 'W', '', 'W', '', '', '', '']],
                        removedMarbles: { black: 0, white: 0 } } } }]);
    });
    it("an inline move ejecting your own marbles  is illegal", function () {
        expectIllegalMove(1, { board: [
                ['', '', '', '', 'O', '', 'O', '', 'O', '', 'B', '', 'O', '', '', '', ''],
                ['', '', '', 'W', '', 'O', '', 'O', '', 'B', '', 'B', '', 'B', '', '', ''],
                ['', '', 'O', '', 'W', '', 'O', '', 'W', '', 'O', '', 'O', '', 'O', '', ''],
                ['', 'O', '', 'O', '', 'W', '', 'W', '', 'W', '', 'B', '', 'B', '', 'B', ''],
                ['O', '', 'O', '', 'O', '', 'O', '', 'B', '', 'W', '', 'O', '', 'O', '', 'O'],
                ['', 'O', '', 'O', '', 'O', '', 'B', '', 'B', '', 'W', '', 'W', '', 'O', ''],
                ['', '', 'O', '', 'O', '', 'B', '', 'B', '', 'B', '', 'O', '', 'O', '', ''],
                ['', '', '', 'B', '', 'O', '', 'O', '', 'W', '', 'W', '', 'W', '', '', ''],
                ['', '', '', '', 'O', '', 'O', '', 'O', '', 'W', '', 'W', '', '', '', '']],
            removedMarbles: { black: 0, white: 0 } }, [{ setTurn: { turnIndex: 0 } },
            { set: { key: 'action', value: { isInline: true, direction: { row: -1, col: -1 },
                        selfMarbles: [{ row: 3, col: 5 }, { row: 2, col: 4 }, { row: 1, col: 3 }],
                        opponentMarbles: [] } } },
            { set: { key: 'state', value: { board: [
                            ['', '', '', '', 'O', '', 'O', '', 'O', '', 'B', '', 'O', '', '', '', ''],
                            ['', '', '', 'W', '', 'O', '', 'O', '', 'B', '', 'B', '', 'B', '', '', ''],
                            ['', '', 'O', '', 'W', '', 'O', '', 'W', '', 'O', '', 'O', '', 'O', '', ''],
                            ['', 'O', '', 'O', '', 'O', '', 'W', '', 'W', '', 'B', '', 'B', '', 'B', ''],
                            ['O', '', 'O', '', 'O', '', 'O', '', 'B', '', 'W', '', 'O', '', 'O', '', 'O'],
                            ['', 'O', '', 'O', '', 'O', '', 'B', '', 'B', '', 'W', '', 'W', '', 'O', ''],
                            ['', '', 'O', '', 'O', '', 'B', '', 'B', '', 'B', '', 'O', '', 'O', '', ''],
                            ['', '', '', 'B', '', 'O', '', 'O', '', 'W', '', 'W', '', 'W', '', '', ''],
                            ['', '', '', '', 'O', '', 'O', '', 'O', '', 'W', '', 'W', '', '', '', '']],
                        removedMarbles: { black: 0, white: 1 } } } }]);
    });
    it("a broadside move of 2 marbles to open space is legal", function () {
        expectMoveOk(0, { board: [
                ['', '', '', '', 'O', '', 'O', '', 'B', '', 'O', '', 'O', '', '', '', ''],
                ['', '', '', 'O', '', 'O', '', 'B', '', 'O', '', 'B', '', 'B', '', '', ''],
                ['', '', 'O', '', 'O', '', 'O', '', 'O', '', 'O', '', 'O', '', 'O', '', ''],
                ['', 'O', '', 'O', '', 'O', '', 'O', '', 'W', '', 'O', '', 'O', '', 'O', ''],
                ['O', '', 'O', '', 'O', '', 'W', '', 'W', '', 'W', '', 'B', '', 'B', '', 'B'],
                ['', 'O', '', 'O', '', 'W', '', 'W', '', 'B', '', 'W', '', 'W', '', 'O', ''],
                ['', '', 'O', '', 'O', '', 'B', '', 'W', '', 'O', '', 'O', '', 'O', '', ''],
                ['', '', '', 'B', '', 'O', '', 'W', '', 'B', '', 'B', '', 'B', '', '', ''],
                ['', '', '', '', 'O', '', 'O', '', 'B', '', 'O', '', 'W', '', '', '', '']],
            removedMarbles: { black: 0, white: 3 } }, [{ setTurn: { turnIndex: 1 } },
            { set: { key: 'action', value: { isInline: false, direction: { row: -1, col: -1 },
                        selfMarbles: [{ row: 7, col: 11 }, { row: 7, col: 13 }],
                        opponentMarbles: [] } } },
            { set: { key: 'state', value: { board: [
                            ['', '', '', '', 'O', '', 'O', '', 'B', '', 'O', '', 'O', '', '', '', ''],
                            ['', '', '', 'O', '', 'O', '', 'B', '', 'O', '', 'B', '', 'B', '', '', ''],
                            ['', '', 'O', '', 'O', '', 'O', '', 'O', '', 'O', '', 'O', '', 'O', '', ''],
                            ['', 'O', '', 'O', '', 'O', '', 'O', '', 'W', '', 'O', '', 'O', '', 'O', ''],
                            ['O', '', 'O', '', 'O', '', 'W', '', 'W', '', 'W', '', 'B', '', 'B', '', 'B'],
                            ['', 'O', '', 'O', '', 'W', '', 'W', '', 'B', '', 'W', '', 'W', '', 'O', ''],
                            ['', '', 'O', '', 'O', '', 'B', '', 'W', '', 'B', '', 'B', '', 'O', '', ''],
                            ['', '', '', 'B', '', 'O', '', 'W', '', 'B', '', 'O', '', 'O', '', '', ''],
                            ['', '', '', '', 'O', '', 'O', '', 'B', '', 'O', '', 'W', '', '', '', '']],
                        removedMarbles: { black: 0, white: 3 } } } }]);
    });
    it("a broadside move of 2 marbles to filled space is illegal", function () {
        expectIllegalMove(0, { board: [
                ['', '', '', '', 'O', '', 'O', '', 'B', '', 'O', '', 'O', '', '', '', ''],
                ['', '', '', 'O', '', 'O', '', 'B', '', 'O', '', 'B', '', 'B', '', '', ''],
                ['', '', 'O', '', 'O', '', 'O', '', 'O', '', 'O', '', 'O', '', 'O', '', ''],
                ['', 'O', '', 'O', '', 'O', '', 'O', '', 'W', '', 'O', '', 'O', '', 'O', ''],
                ['O', '', 'O', '', 'O', '', 'W', '', 'W', '', 'W', '', 'B', '', 'B', '', 'B'],
                ['', 'O', '', 'O', '', 'W', '', 'W', '', 'B', '', 'W', '', 'W', '', 'O', ''],
                ['', '', 'O', '', 'O', '', 'B', '', 'W', '', 'O', '', 'O', '', 'O', '', ''],
                ['', '', '', 'B', '', 'O', '', 'W', '', 'B', '', 'B', '', 'B', '', '', ''],
                ['', '', '', '', 'O', '', 'O', '', 'B', '', 'O', '', 'W', '', '', '', '']],
            removedMarbles: { black: 0, white: 3 } }, [{ setTurn: { turnIndex: 1 } },
            { set: { key: 'action', value: { isInline: false, direction: { row: -1, col: -1 },
                        selfMarbles: [{ row: 7, col: 9 }, { row: 7, col: 11 }],
                        opponentMarbles: [] } } },
            { set: { key: 'state', value: { board: [
                            ['', '', '', '', 'O', '', 'O', '', 'B', '', 'O', '', 'O', '', '', '', ''],
                            ['', '', '', 'O', '', 'O', '', 'B', '', 'O', '', 'B', '', 'B', '', '', ''],
                            ['', '', 'O', '', 'O', '', 'O', '', 'O', '', 'O', '', 'O', '', 'O', '', ''],
                            ['', 'O', '', 'O', '', 'W', '', 'O', '', 'W', '', 'O', '', 'O', '', 'O', ''],
                            ['O', '', 'O', '', 'O', '', 'W', '', 'W', '', 'W', '', 'B', '', 'B', '', 'B'],
                            ['', 'O', '', 'O', '', 'W', '', 'W', '', 'B', '', 'W', '', 'W', '', 'O', ''],
                            ['', '', 'O', '', 'O', '', 'B', '', 'B', '', 'B', '', 'O', '', 'O', '', ''],
                            ['', '', '', 'B', '', 'O', '', 'W', '', 'O', '', 'O', '', 'B', '', '', ''],
                            ['', '', '', '', 'O', '', 'O', '', 'B', '', 'O', '', 'W', '', '', '', '']],
                        removedMarbles: { black: 0, white: 3 } } } }]);
    });
    it("a broadside move of 2 marbles not next to each other is illegal", function () {
        expectIllegalMove(0, { board: [
                ['', '', '', '', 'O', '', 'O', '', 'B', '', 'O', '', 'O', '', '', '', ''],
                ['', '', '', 'O', '', 'O', '', 'B', '', 'O', '', 'B', '', 'B', '', '', ''],
                ['', '', 'O', '', 'O', '', 'O', '', 'O', '', 'O', '', 'O', '', 'O', '', ''],
                ['', 'O', '', 'O', '', 'O', '', 'O', '', 'W', '', 'O', '', 'O', '', 'O', ''],
                ['O', '', 'O', '', 'O', '', 'W', '', 'W', '', 'W', '', 'B', '', 'B', '', 'B'],
                ['', 'O', '', 'O', '', 'W', '', 'W', '', 'B', '', 'W', '', 'W', '', 'O', ''],
                ['', '', 'O', '', 'O', '', 'B', '', 'W', '', 'O', '', 'O', '', 'O', '', ''],
                ['', '', '', 'B', '', 'O', '', 'W', '', 'B', '', 'B', '', 'B', '', '', ''],
                ['', '', '', '', 'O', '', 'O', '', 'B', '', 'O', '', 'W', '', '', '', '']],
            removedMarbles: { black: 0, white: 3 } }, [{ setTurn: { turnIndex: 1 } },
            { set: { key: 'action', value: { isInline: false, direction: { row: 0, col: 2 },
                        selfMarbles: [{ row: 7, col: 3 }, { row: 8, col: 8 }],
                        opponentMarbles: [] } } },
            { set: { key: 'state', value: { board: [
                            ['', '', '', '', 'O', '', 'O', '', 'B', '', 'O', '', 'O', '', '', '', ''],
                            ['', '', '', 'O', '', 'O', '', 'B', '', 'O', '', 'B', '', 'B', '', '', ''],
                            ['', '', 'O', '', 'O', '', 'O', '', 'O', '', 'O', '', 'O', '', 'O', '', ''],
                            ['', 'O', '', 'O', '', 'O', '', 'O', '', 'W', '', 'O', '', 'O', '', 'O', ''],
                            ['O', '', 'O', '', 'O', '', 'W', '', 'W', '', 'W', '', 'B', '', 'B', '', 'B'],
                            ['', 'O', '', 'O', '', 'W', '', 'W', '', 'B', '', 'W', '', 'W', '', 'O', ''],
                            ['', '', 'O', '', 'O', '', 'B', '', 'W', '', 'O', '', 'O', '', 'O', '', ''],
                            ['', '', '', 'O', '', 'B', '', 'W', '', 'B', '', 'B', '', 'B', '', '', ''],
                            ['', '', '', '', 'O', '', 'O', '', 'O', '', 'B', '', 'W', '', '', '', '']],
                        removedMarbles: { black: 0, white: 3 } } } }]);
    });
    it("moving 1 marble to open space broadside is legal", function () {
        expectMoveOk(1, { board: [
                ['', '', '', '', 'O', '', 'O', '', 'O', '', 'O', '', 'O', '', '', '', ''],
                ['', '', '', 'O', '', 'O', '', 'O', '', 'O', '', 'W', '', 'O', '', '', ''],
                ['', '', 'O', '', 'O', '', 'O', '', 'B', '', 'B', '', 'O', '', 'O', '', ''],
                ['', 'O', '', 'O', '', 'B', '', 'B', '', 'B', '', 'B', '', 'B', '', 'O', ''],
                ['O', '', 'O', '', 'B', '', 'W', '', 'W', '', 'O', '', 'O', '', 'O', '', 'O'],
                ['', 'O', '', 'O', '', 'W', '', 'W', '', 'O', '', 'W', '', 'B', '', 'O', ''],
                ['', '', 'O', '', 'O', '', 'O', '', 'W', '', 'W', '', 'B', '', 'B', '', ''],
                ['', '', '', 'O', '', 'B', '', 'O', '', 'O', '', 'W', '', 'O', '', '', ''],
                ['', '', '', '', 'O', '', 'O', '', 'O', '', 'O', '', 'B', '', '', '', '']],
            removedMarbles: { black: 1, white: 5 } }, [{ setTurn: { turnIndex: 0 } },
            { set: { key: 'action', value: { isInline: false, direction: { row: -1, col: -1 },
                        selfMarbles: [{ row: 1, col: 11 }],
                        opponentMarbles: [] } } },
            { set: { key: 'state', value: { board: [
                            ['', '', '', '', 'O', '', 'O', '', 'O', '', 'W', '', 'O', '', '', '', ''],
                            ['', '', '', 'O', '', 'O', '', 'O', '', 'O', '', 'O', '', 'O', '', '', ''],
                            ['', '', 'O', '', 'B', '', 'B', '', 'B', '', 'B', '', 'O', '', 'O', '', ''],
                            ['', 'O', '', 'B', '', 'O', '', 'O', '', 'B', '', 'B', '', 'B', '', 'O', ''],
                            ['O', '', 'O', '', 'O', '', 'W', '', 'W', '', 'O', '', 'O', '', 'O', '', 'O'],
                            ['', 'O', '', 'O', '', 'W', '', 'W', '', 'O', '', 'W', '', 'B', '', 'O', ''],
                            ['', '', 'O', '', 'O', '', 'O', '', 'W', '', 'W', '', 'B', '', 'B', '', ''],
                            ['', '', '', 'O', '', 'B', '', 'O', '', 'O', '', 'W', '', 'O', '', '', ''],
                            ['', '', '', '', 'O', '', 'O', '', 'O', '', 'O', '', 'B', '', '', '', '']],
                        removedMarbles: { black: 1, white: 5 } } } }]);
    });
    it("moving 3 marbles not in the same line is illegal", function () {
        expectIllegalMove(0, { board: [
                ['', '', '', '', 'O', '', 'O', '', 'O', '', 'O', '', 'O', '', '', '', ''],
                ['', '', '', 'O', '', 'O', '', 'O', '', 'O', '', 'W', '', 'O', '', '', ''],
                ['', '', 'O', '', 'O', '', 'O', '', 'B', '', 'B', '', 'O', '', 'O', '', ''],
                ['', 'O', '', 'O', '', 'B', '', 'B', '', 'B', '', 'B', '', 'B', '', 'O', ''],
                ['O', '', 'O', '', 'B', '', 'W', '', 'W', '', 'O', '', 'O', '', 'O', '', 'O'],
                ['', 'O', '', 'O', '', 'W', '', 'W', '', 'O', '', 'W', '', 'B', '', 'O', ''],
                ['', '', 'O', '', 'O', '', 'O', '', 'W', '', 'W', '', 'B', '', 'B', '', ''],
                ['', '', '', 'O', '', 'B', '', 'O', '', 'O', '', 'W', '', 'O', '', '', ''],
                ['', '', '', '', 'O', '', 'O', '', 'O', '', 'O', '', 'B', '', '', '', '']],
            removedMarbles: { black: 1, white: 5 } }, [{ setTurn: { turnIndex: 1 } },
            { set: { key: 'action', value: { isInline: false, direction: { row: -1, col: -1 },
                        selfMarbles: [{ row: 4, col: 4 }, { row: 3, col: 5 }, { row: 3, col: 7 }],
                        opponentMarbles: [] } } },
            { set: { key: 'state', value: { board: [
                            ['', '', '', '', 'O', '', 'O', '', 'O', '', 'O', '', 'O', '', '', '', ''],
                            ['', '', '', 'O', '', 'O', '', 'O', '', 'O', '', 'W', '', 'O', '', '', ''],
                            ['', '', 'O', '', 'B', '', 'B', '', 'B', '', 'B', '', 'O', '', 'O', '', ''],
                            ['', 'O', '', 'B', '', 'O', '', 'O', '', 'B', '', 'B', '', 'B', '', 'O', ''],
                            ['O', '', 'O', '', 'O', '', 'W', '', 'W', '', 'O', '', 'O', '', 'O', '', 'O'],
                            ['', 'O', '', 'O', '', 'W', '', 'W', '', 'O', '', 'W', '', 'B', '', 'O', ''],
                            ['', '', 'O', '', 'O', '', 'O', '', 'W', '', 'W', '', 'B', '', 'B', '', ''],
                            ['', '', '', 'O', '', 'B', '', 'O', '', 'O', '', 'W', '', 'O', '', '', ''],
                            ['', '', '', '', 'O', '', 'O', '', 'O', '', 'O', '', 'B', '', '', '', '']],
                        removedMarbles: { black: 1, white: 5 } } } }]);
    });
    it("moving in a finished game is illegal", function () {
        expectIllegalMove(0, { board: [
                ['', '', '', '', 'O', '', 'O', '', 'O', '', 'B', '', 'O', '', '', '', ''],
                ['', '', '', 'O', '', 'O', '', 'O', '', 'B', '', 'B', '', 'O', '', '', ''],
                ['', '', 'O', '', 'O', '', 'O', '', 'O', '', 'B', '', 'O', '', 'O', '', ''],
                ['', 'O', '', 'O', '', 'B', '', 'B', '', 'O', '', 'O', '', 'B', '', 'O', ''],
                ['O', '', 'O', '', 'B', '', 'W', '', 'W', '', 'O', '', 'O', '', 'O', '', 'O'],
                ['', 'O', '', 'O', '', 'W', '', 'W', '', 'O', '', 'W', '', 'B', '', 'O', ''],
                ['', '', 'O', '', 'O', '', 'O', '', 'W', '', 'W', '', 'B', '', 'B', '', ''],
                ['', '', '', 'O', '', 'B', '', 'O', '', 'O', '', 'W', '', 'O', '', '', ''],
                ['', '', '', '', 'O', '', 'O', '', 'O', '', 'O', '', 'B', '', '', '', '']],
            removedMarbles: { black: 1, white: 6 } }, [{ setTurn: { turnIndex: 1 } },
            { set: { key: 'action', value: { isInline: true, direction: { row: -1, col: 1 },
                        selfMarbles: [{ row: 8, col: 12 }],
                        opponentMarbles: [] } } },
            { set: { key: 'state', value: { board: [
                            ['', '', '', '', 'O', '', 'O', '', 'O', '', 'B', '', 'O', '', '', '', ''],
                            ['', '', '', 'O', '', 'O', '', 'O', '', 'B', '', 'B', '', 'O', '', '', ''],
                            ['', '', 'O', '', 'O', '', 'O', '', 'O', '', 'B', '', 'O', '', 'O', '', ''],
                            ['', 'O', '', 'O', '', 'B', '', 'B', '', 'O', '', 'O', '', 'B', '', 'O', ''],
                            ['O', '', 'O', '', 'B', '', 'W', '', 'W', '', 'O', '', 'O', '', 'O', '', 'O'],
                            ['', 'O', '', 'O', '', 'W', '', 'W', '', 'O', '', 'W', '', 'B', '', 'O', ''],
                            ['', '', 'O', '', 'O', '', 'O', '', 'W', '', 'W', '', 'B', '', 'B', '', ''],
                            ['', '', '', 'O', '', 'B', '', 'O', '', 'O', '', 'W', '', 'B', '', '', ''],
                            ['', '', '', '', 'O', '', 'O', '', 'O', '', 'O', '', 'O', '', '', '', '']],
                        removedMarbles: { black: 1, white: 6 } } } }]);
    });
});
